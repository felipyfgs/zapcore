### ============================================================================
### WAMEX API - Testes Completos Consolidados
### Sistema de Envio de Mensagens WhatsApp com Suporte Multi-Source
### ============================================================================

@baseUrl = http://localhost:8080
@sessionName = teste
@testPhone = 559981769536

### ============================================================================
### 1. GERENCIAMENTO DE SESS√ïES
### ============================================================================

### Criar nova sess√£o
POST {{baseUrl}}/sessions/add
Content-Type: application/json

{
  "session": "{{sessionName}}"
}

### Conectar sess√£o
POST {{baseUrl}}/sessions/{{sessionName}}/connect

### Status da sess√£o
GET {{baseUrl}}/sessions/{{sessionName}}/status

### Listar todas as sess√µes
GET {{baseUrl}}/sessions/list

### Desconectar sess√£o
POST {{baseUrl}}/sessions/{{sessionName}}/disconnect

### Deletar sess√£o
DELETE {{baseUrl}}/sessions/{{sessionName}}

### ============================================================================
### 2. MENSAGENS DE TEXTO
### ============================================================================

### Mensagem de texto simples
POST {{baseUrl}}/message/{{sessionName}}/send/text
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "body": "üìù WAMEX: Mensagem de texto funcionando! ‚úÖ"
}

### Mensagem de texto longa
POST {{baseUrl}}/message/{{sessionName}}/send/text
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "body": "üìù TESTE LONGO: Esta √© uma mensagem mais longa para testar o sistema WAMEX. O sistema suporta mensagens de at√© 4096 caracteres, permitindo envio de textos extensos com formata√ß√£o, emojis üéâ e quebras de linha.\n\nNova linha aqui!\n\n‚úÖ Sistema funcionando perfeitamente!"
}

### ============================================================================
### 3. M√çDIA MULTI-SOURCE - NOVA FUNCIONALIDADE
### ============================================================================

### 3.1 ENVIO VIA MINIO ID (Compatibilidade)
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "mediaId": "4a5347eb-33c5-4048-babc-0661cbba1b9b",
  "caption": "üì¶ MINIO: M√≠dia enviada via MinIO ID (compatibilidade)"
}

### 3.2 ENVIO VIA BASE64
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "base64": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k=",
  "caption": "üî¢ BASE64: Imagem pequena enviada via base64",
  "filename": "teste-base64.jpg"
}

### 3.3 ENVIO VIA URL EXTERNA
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://github.com/felipyfgs/wamex/raw/main/assets/image.jpeg",
  "caption": "üåê URL: Imagem enviada via URL externa do GitHub",
  "filename": "github-image.jpg"
}

### 3.4 ENVIO VIA UPLOAD DIRETO (MULTIPART)
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="phone"

{{testPhone}}
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="caption"

üì§ UPLOAD: Arquivo enviado diretamente via multipart
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="upload-direto.jpg"
Content-Type: image/jpeg

< ./assets/image.jpeg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### ============================================================================
### 4. M√çDIA MULTI-SOURCE - DIFERENTES TIPOS
### ============================================================================

### 4.1 IMAGEM PNG VIA URL
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://via.placeholder.com/300x300.png?text=WAMEX+PNG",
  "caption": "üñºÔ∏è PNG: Imagem PNG via URL externa"
}

### 4.2 DOCUMENTO PDF VIA URL
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://github.com/felipyfgs/wamex/raw/main/assets/pdf.pdf",
  "caption": "üìÑ PDF: Documento PDF via URL",
  "messageType": "document"
}

### 4.3 √ÅUDIO VIA URL
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://github.com/felipyfgs/wamex/raw/main/assets/audio.ogg",
  "caption": "üéµ √ÅUDIO: Arquivo de √°udio via URL"
}

### 4.4 STICKER VIA URL
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://via.placeholder.com/512x512.webp?text=STICKER",
  "messageType": "sticker"
}

### ============================================================================
### 5. M√çDIA TRADICIONAL (COMPATIBILIDADE)
### ============================================================================

### 5.1 IMAGEM TRADICIONAL
POST {{baseUrl}}/message/{{sessionName}}/send/image
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://github.com/felipyfgs/wamex/raw/main/assets/image.jpeg",
  "caption": "üñºÔ∏è TRADICIONAL: Imagem via rota espec√≠fica"
}

### 5.2 √ÅUDIO TRADICIONAL
POST {{baseUrl}}/message/{{sessionName}}/send/audio
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://github.com/felipyfgs/wamex/raw/main/assets/audio.ogg",
  "ptt": true
}

### 5.3 DOCUMENTO TRADICIONAL
POST {{baseUrl}}/message/{{sessionName}}/send/document
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://github.com/felipyfgs/wamex/raw/main/assets/pdf.pdf",
  "filename": "documento-tradicional.pdf",
  "caption": "üìÑ TRADICIONAL: Documento via rota espec√≠fica"
}

### 5.4 V√çDEO TRADICIONAL
POST {{baseUrl}}/message/{{sessionName}}/send/video
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
  "caption": "üé¨ TRADICIONAL: V√≠deo via rota espec√≠fica"
}

### 5.5 STICKER TRADICIONAL
POST {{baseUrl}}/message/{{sessionName}}/send/sticker
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://via.placeholder.com/512x512.webp?text=STICKER"
}

### ============================================================================
### 6. UPLOAD E GERENCIAMENTO DE M√çDIA
### ============================================================================

### 6.1 UPLOAD DE IMAGEM
POST {{baseUrl}}/media/upload
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="test-image.jpg"
Content-Type: image/jpeg

< ./assets/image.jpeg
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="filename"

minha-imagem-teste.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### 6.2 UPLOAD DE DOCUMENTO PDF
POST {{baseUrl}}/media/upload
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="test-document.pdf"
Content-Type: application/pdf

< ./assets/pdf.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="filename"

documento-teste.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### 6.3 UPLOAD DE √ÅUDIO
POST {{baseUrl}}/media/upload
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="test-audio.ogg"
Content-Type: audio/ogg

< ./assets/audio.ogg
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="filename"

audio-teste.ogg
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="sessionName"

{{sessionName}}
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### 6.4 LISTAGEM DE M√çDIAS - Todas
GET {{baseUrl}}/media/list

### 6.5 LISTAGEM DE M√çDIAS - Com pagina√ß√£o
GET {{baseUrl}}/media/list?limit=10&offset=0

### 6.6 LISTAGEM DE M√çDIAS - Filtrada por tipo
GET {{baseUrl}}/media/list?type=image

### 6.7 LISTAGEM DE M√çDIAS - Filtrada por sess√£o
GET {{baseUrl}}/media/list?sessionName={{sessionName}}

### 6.8 DOWNLOAD DE M√çDIA - Por ID (substitua MEDIA_ID_AQUI)
GET {{baseUrl}}/media/MEDIA_ID_AQUI/download

### 6.9 DELE√á√ÉO DE M√çDIA - Por ID (substitua MEDIA_ID_AQUI)
DELETE {{baseUrl}}/media/MEDIA_ID_AQUI

### ============================================================================
### 7. OUTRAS MENSAGENS
### ============================================================================

### 7.1 LOCALIZA√á√ÉO
POST {{baseUrl}}/message/{{sessionName}}/send/location
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "latitude": -23.5505,
  "longitude": -46.6333,
  "name": "S√£o Paulo, SP - Brasil"
}

### 7.2 CONTATO
POST {{baseUrl}}/message/{{sessionName}}/send/contact
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "name": "Jo√£o Silva",
  "vcard": "BEGIN:VCARD\nVERSION:3.0\nFN:Jo√£o Silva\nORG:WAMEX Corp\nTEL:+5511999887766\nEMAIL:joao@wamex.com\nEND:VCARD"
}

### 7.3 REA√á√ÉO A MENSAGEM (substitua messageId)
POST {{baseUrl}}/message/{{sessionName}}/react
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "messageId": "3EB0C431C26A1916E07A",
  "reaction": "üëç"
}

### 7.4 EDITAR MENSAGEM (substitua messageId)
POST {{baseUrl}}/message/{{sessionName}}/edit
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "messageId": "3EB0C431C26A1916E07A",
  "newText": "‚úèÔ∏è EDITADO: Esta mensagem foi editada via WAMEX API!"
}

### ============================================================================
### 8. ENQUETES (APENAS GRUPOS)
### ============================================================================

### 8.1 ENQUETE SIMPLES - Sim/N√£o
POST {{baseUrl}}/message/{{sessionName}}/send/poll
Content-Type: application/json

{
  "phone": "120363025343123456@g.us",
  "header": "üó≥Ô∏è Voc√™ gosta do sistema WAMEX?",
  "options": ["üëç Sim, muito bom!", "üëé N√£o, precisa melhorar"],
  "maxSelections": 1
}

### 8.2 ENQUETE M√öLTIPLA ESCOLHA
POST {{baseUrl}}/message/{{sessionName}}/send/poll
Content-Type: application/json

{
  "phone": "120363025343123456@g.us",
  "header": "üíª Quais linguagens voc√™ programa? (m√∫ltipla escolha)",
  "options": ["Go", "Python", "JavaScript", "Java", "C#", "PHP", "Rust", "Outras"],
  "maxSelections": 3
}

### ============================================================================
### 9. LISTAS INTERATIVAS
### ============================================================================

### 9.1 LISTA DE MENU
POST {{baseUrl}}/message/{{sessionName}}/send/list
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "header": "üçΩÔ∏è Menu do Restaurante",
  "body": "Escolha seu prato favorito do nosso menu especial:",
  "footer": "Pre√ßos sujeitos a altera√ß√£o",
  "buttonText": "Ver Menu",
  "sections": [
    {
      "title": "Pratos Principais",
      "rows": [
        {
          "title": "üçï Pizza Margherita",
          "description": "Molho de tomate, mussarela e manjeric√£o - R$ 35,00",
          "rowId": "pizza_margherita"
        },
        {
          "title": "üçî Hamb√∫rguer Artesanal",
          "description": "Carne 180g, queijo, alface, tomate - R$ 28,00",
          "rowId": "hamburguer_artesanal"
        }
      ]
    },
    {
      "title": "Bebidas",
      "rows": [
        {
          "title": "ü•§ Refrigerante",
          "description": "Coca-Cola, Pepsi, Guaran√° - R$ 8,00",
          "rowId": "refrigerante"
        }
      ]
    }
  ]
}

### ============================================================================
### 10. TESTES DE ERRO E VALIDA√á√ÉO
### ============================================================================

### 10.1 ERRO - Sess√£o inexistente
POST {{baseUrl}}/message/sessao-inexistente/send/text
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "body": "Teste com sess√£o inexistente"
}

### 10.2 ERRO - Telefone inv√°lido
POST {{baseUrl}}/message/{{sessionName}}/send/text
Content-Type: application/json

{
  "phone": "123",
  "body": "Teste com telefone inv√°lido"
}

### 10.3 ERRO - M√≠dia sem fonte
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "caption": "Teste sem nenhuma fonte de m√≠dia"
}

### 10.4 ERRO - M√∫ltiplas fontes de m√≠dia
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "mediaId": "123",
  "base64": "data:image/jpeg;base64,/9j/4AAQ...",
  "caption": "Teste com m√∫ltiplas fontes (erro)"
}

### 10.5 ERRO - URL inv√°lida
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "url-invalida",
  "caption": "Teste com URL inv√°lida"
}

### 10.6 ERRO - Base64 inv√°lido
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "base64": "base64-invalido",
  "caption": "Teste com base64 inv√°lido"
}

### ============================================================================
### 11. FLUXOS COMPLETOS DE TESTE
### ============================================================================

### 11.1 FLUXO COMPLETO - Upload ‚Üí Envio ‚Üí Download ‚Üí Delete
### Passo 1: Upload da imagem
POST {{baseUrl}}/media/upload
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="fluxo-completo.jpg"
Content-Type: image/jpeg

< ./assets/image.jpeg
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="filename"

fluxo-completo-teste.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Passo 2: Enviar via WhatsApp (substitua MEDIA_ID_DO_PASSO_1)
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "mediaId": "MEDIA_ID_DO_PASSO_1",
  "caption": "Fluxo completo: Upload ‚Üí Envio ‚Üí Download ‚Üí Delete ‚úÖ"
}

### Passo 3: Download da m√≠dia
GET {{baseUrl}}/media/MEDIA_ID_DO_PASSO_1/download

### Passo 4: Deletar a m√≠dia
DELETE {{baseUrl}}/media/MEDIA_ID_DO_PASSO_1

### 11.2 TESTE SEQUENCIAL - Todas as fontes de m√≠dia
### Texto inicial
POST {{baseUrl}}/message/{{sessionName}}/send/text
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "body": "üöÄ TESTE MULTI-SOURCE: Iniciando teste de todas as fontes de m√≠dia!"
}

### MinIO ID (se dispon√≠vel)
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "mediaId": "4a5347eb-33c5-4048-babc-0661cbba1b9b",
  "caption": "‚úÖ 1/4: MinIO ID"
}

### Base64
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "base64": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k=",
  "caption": "‚úÖ 2/4: Base64"
}

### URL Externa
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "url": "https://github.com/felipyfgs/wamex/raw/main/assets/image.jpeg",
  "caption": "‚úÖ 3/4: URL Externa"
}

### Upload Direto
POST {{baseUrl}}/message/{{sessionName}}/send/media
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="phone"

{{testPhone}}
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="caption"

‚úÖ 4/4: Upload Direto
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="upload-final.jpg"
Content-Type: image/jpeg

< ./assets/image.jpeg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Finaliza√ß√£o
POST {{baseUrl}}/message/{{sessionName}}/send/text
Content-Type: application/json

{
  "phone": "{{testPhone}}",
  "body": "üéâ TESTE MULTI-SOURCE FINALIZADO! Todas as 4 fontes de m√≠dia foram testadas com sucesso! ‚úÖ\n\nüì¶ MinIO ID\nüî¢ Base64\nüåê URL Externa\nüì§ Upload Direto"
}

### ============================================================================
### 12. INFORMA√á√ïES E DOCUMENTA√á√ÉO
### ============================================================================

### NOVA FUNCIONALIDADE MULTI-SOURCE:
### ‚úÖ POST /message/{sessionID}/send/media agora suporta 4 fontes:
###   1. mediaId - MinIO ID (compatibilidade)
###   2. base64 - Data URL base64
###   3. url - URL externa
###   4. file - Upload direto via multipart
###
### DETEC√á√ÉO AUTOM√ÅTICA:
### ‚úÖ Tipo MIME detectado automaticamente
### ‚úÖ Tipo de mensagem WhatsApp detectado
### ‚úÖ Valida√ß√µes de seguran√ßa implementadas
###
### RESPOSTA UNIFICADA:
### ‚úÖ Informa√ß√µes detalhadas sobre processamento
### ‚úÖ Tempo de processamento
### ‚úÖ Fonte utilizada
### ‚úÖ Metadados da m√≠dia
###
### COMPATIBILIDADE:
### ‚úÖ Rotas antigas mantidas funcionando
### ‚úÖ MinIO ID continua funcionando
### ‚úÖ Sistema existente preservado
###
### SEGURAN√áA:
### ‚úÖ Valida√ß√£o de magic numbers
### ‚úÖ Whitelist de dom√≠nios para URLs
### ‚úÖ Rate limiting implementado
### ‚úÖ Valida√ß√£o de tamanhos por tipo
###
### ARQUIVOS DE TESTE NECESS√ÅRIOS:
### - ./assets/image.jpeg
### - ./assets/audio.ogg
### - ./assets/pdf.pdf
###
### VARI√ÅVEIS:
### @baseUrl = http://localhost:8080
### @sessionName = teste
### @testPhone = 559981769536